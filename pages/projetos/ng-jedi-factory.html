<div class="container-fluid">
    <div class="row">
        <div class="col-lg-12">
            <h1 class="page-header">ng-jedi-factory</h1>
        </div>
        <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->

    <div class="col-lg-12">


        <p>Factory helper to easily create angularjs components (controllers, directives, filters...) and ensure that all dependencies are loaded before it, using requirejs. In other words, the factory easily integrates requirejs and angular. The factory should be used on a javascript file to declare same angularjs components types. Each component type has a factory function. See more below.</p>

        <h3><a id="user-content-install" class="anchor" href="#install" aria-hidden="true"><span class="octicon octicon-link"></span></a>Install</h3>

        <ul>
            <li>
                <p>Install the dependency:</p>

                <div class="highlight highlight-shell"><pre>bower install ng-jedi-factory --save</pre>
                </div>
            </li>
            <li>
                <p>Add factory.js to your code:</p>

                <div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">script</span> <span class="pl-e">src</span>=<span class="pl-s"><span class="pl-pds">'</span>assets/libs/ng-jedi-factory/factory.js<span class="pl-pds">'</span></span>&gt;&lt;/<span class="pl-ent">script</span>&gt;</pre>
                </div>

                <ul>
                    <li>note that the base directory used was assets/libs, you should change bower_components to assets/libs or move from bower_components to assets/libs with grunt.</li>
                </ul>
            </li>
            <li>
                <p>Include module dependency:</p>

                <div class="highlight highlight-javascript"><pre>angular.<span class="pl-c1">module</span>(<span class="pl-s"><span class="pl-pds">'</span>yourApp<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>jedi.factory<span class="pl-pds">'</span></span>]);</pre>
                </div>
            </li>
            <li>
                <p>Requirements:</p>

                <ul>
                    <li>the factory works with control of script version and loads the correct script based on version mapper. Your app should have a version.json file, where you should write the mapping between original js file and version-named js file. The version.json file is loaded on load factory, using requirejs. The version.json content should be similar to:</li>
                </ul>

                <div class="highlight highlight-json"><pre>{
  <span class="pl-s"><span class="pl-pds">"</span>version<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>1.0.0<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>files<span class="pl-pds">"</span></span>: {
     <span class="pl-s"><span class="pl-pds">"</span>yourScript.js<span class="pl-pds">"</span></span>: <span class="pl-s"><span class="pl-pds">"</span>yourScript-hashGenOnBuild.js<span class="pl-pds">"</span></span>
  }
}</pre>
                </div>

                <ul>
                    <li>version.json</li>
                    <li>lodash: it's used in internal statements</li>
                    <li>jedi.dialogs: it's used to open the modal (newModal function below)</li>
                    <li>requirejs: it's used to load the module scripts (app.js, env.js, etc).</li>
                    <li>restangular: it's used to create a restangular factory to the module (newModule function below).</li>
                    <li>file-saver-saveas-js: it's used to expose methods to download using restangular factory.</li>
                </ul>
            </li>
        </ul>

        <h1></h1>

        <h3><a id="user-content-how-to-use" class="anchor" href="#how-to-use" aria-hidden="true"><span class="octicon octicon-link"></span></a>How To Use</h3>

        <ol>
            <li>
                <p><strong>newController(controllerName, func)</strong>
                </p>

                <ul>
                    <li>this function creates a new controller in your angular module</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newController</span>(<span class="pl-s"><span class="pl-pds">"</span>yourController<span class="pl-pds">"</span></span>, [<span class="pl-k">function</span> () {
  <span class="pl-c">// your controller body</span>
  <span class="pl-c">// we recommend writting the controller using vm pattern</span>
}]);</pre>
                </div>
            </li>
            <li>
                <p><strong>newService(serviceName, api, actions, params)</strong>
                </p>

                <ul>
                    <li>this function creates a new service based in $resource</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newService</span>(<span class="pl-s"><span class="pl-pds">"</span>yourService<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">'</span>api/myAction/:userId<span class="pl-pds">'</span></span>, {<span class="pl-s"><span class="pl-pds">'</span>get<span class="pl-pds">'</span></span><span class="pl-k">:</span> {method<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>GET<span class="pl-pds">'</span></span>}}, {itemId<span class="pl-k">:</span><span class="pl-s"><span class="pl-pds">'</span>@id<span class="pl-pds">'</span></span>});
.
.
<span class="pl-c">// using 'yourService' in a controller</span>
app.<span class="pl-c1">controller</span>([<span class="pl-s"><span class="pl-pds">'</span>yourService<span class="pl-pds">'</span></span>, <span class="pl-k">function</span> (<span class="pl-smi">yourService</span>) {
  <span class="pl-k">var</span> item <span class="pl-k">=</span> yourService.<span class="pl-c1">get</span>(id);
  item.<span class="pl-c1">post</span>();
}])</pre>
                </div>
            </li>
            <li>
                <p><strong>newModal(directiveName, templateUrl, controllerName, injection, modalOptions)</strong>
                </p>

                <ul>
                    <li>this function creates a new directive and a controller at the same time, to open as a modal. It uses jedi.dialogs.ModalHelper to open the modal.</li>
                    <li>directiveName: directive name that will be created</li>
                    <li>templateUrl: url to your html</li>
                    <li>controllerName: controller name that will be created</li>
                    <li>injection: it's an array that represent injections, input params and the controller function. Important: if your controller needs input parametters, you should declare them imediately before the controller function, in an array of strings.</li>
                    <li>modalOptions: modal options, e.g. {size: 'lg'}</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newModal</span>(<span class="pl-s"><span class="pl-pds">"</span>yourModalDirective<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">'</span>app/view/yourModal.html<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>myService<span class="pl-pds">'</span></span>, [<span class="pl-s"><span class="pl-pds">'</span>param1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>param2<span class="pl-pds">'</span></span>], <span class="pl-k">function</span> (<span class="pl-smi">myService</span>, <span class="pl-smi">param1</span>, <span class="pl-smi">param2</span>) {
  <span class="pl-c">// your controller body</span>
  <span class="pl-c">// we recommend writting the controller using the vm pattern</span>
}], {size<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>lg<span class="pl-pds">'</span></span>});</pre>
                </div>

                <div class="highlight highlight-html"><pre>&lt;<span class="pl-ent">button</span> <span class="pl-e">your-modal-directive</span>&gt;&lt;/<span class="pl-ent">button</span>&gt;
Or
&lt;<span class="pl-ent">input</span> <span class="pl-e">your-modal-directive</span>=<span class="pl-s"><span class="pl-pds">"</span>onblur<span class="pl-pds">"</span></span>&gt;</pre>
                </div>

                <ul>
                    <li>the example above will open the page 'app/view/yourModal.html' in a modal using $modal (an angular-bootstrap component)</li>
                </ul>
            </li>
            <li>
                <p><strong>newDirective(name, injects)</strong>
                </p>

                <ul>
                    <li>this function creates a new directive in your angular module</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newDirective</span>(<span class="pl-s"><span class="pl-pds">"</span>yourDirective<span class="pl-pds">"</span></span>, [<span class="pl-k">function</span> () {
  <span class="pl-k">return</span> {
     restrict<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>A<span class="pl-pds">'</span></span>,
     <span class="pl-en">link</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">scope</span>, <span class="pl-smi">element</span>, <span class="pl-smi">attrs</span>) {
     ...
     }
  }
}]);</pre>
                </div>
            </li>
            <li>
                <p><strong>newFilter(name, injects)</strong>
                </p>

                <ul>
                    <li>this function creates a new filter in your angular module</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newFilter</span>(<span class="pl-s"><span class="pl-pds">'</span>haveModuleWithFeatures<span class="pl-pds">'</span></span>, [<span class="pl-k">function</span> () {
  <span class="pl-k">return</span> <span class="pl-k">function</span> (<span class="pl-smi">values</span>) {
     <span class="pl-k">return</span> ...;
  }
]);</pre>
                </div>
            </li>
            <li>
                <p><strong>newModule(module, options)</strong>
                </p>

                <ul>
                    <li>this function creates a module in your angular app</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">newModule</span>(<span class="pl-s"><span class="pl-pds">'</span>myModule<span class="pl-pds">'</span></span>, {
  externalDeps<span class="pl-k">:</span> [<span class="pl-c">/*external scripts needed in this module, ex: jquery, dojo, angular-ngMask, etc...*/</span>
     <span class="pl-s"><span class="pl-pds">'</span>assets/libs/externalScript1.js<span class="pl-pds">'</span></span>,
     <span class="pl-s"><span class="pl-pds">'</span>assets/libs/externalScript2.js<span class="pl-pds">'</span></span>
  ],
  angularModules<span class="pl-k">:</span> [<span class="pl-c">/*angular modules that depends on this module*/</span>
     <span class="pl-s"><span class="pl-pds">'</span>ngMask<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>ngResources<span class="pl-pds">'</span></span>
  ],
  internalDeps<span class="pl-k">:</span> [<span class="pl-c">/*internal scripts needed in this module, ex: directives, filters, controllers, etc...*/</span>
     <span class="pl-s"><span class="pl-pds">'</span>app/mymodule/directives/my-directives.js<span class="pl-pds">'</span></span>
  ],
  config<span class="pl-k">:</span> [<span class="pl-c">/*angular config block for this module*/</span>
     <span class="pl-s"><span class="pl-pds">'</span>ngMaskConfig<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">ngMaskConfig</span>){
        ...
     }
  ],
  run<span class="pl-k">:</span> [<span class="pl-c">/*angular run block for this module*/</span>
     <span class="pl-s"><span class="pl-pds">'</span>$rootScope<span class="pl-pds">'</span></span>, <span class="pl-k">function</span>(<span class="pl-smi">$rootScope</span>){
        ...
     }
  ],
  envJsPath<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/{module}/env/{module}-env.js<span class="pl-pds">'</span></span>, <span class="pl-c">// path to module env settings, if null the load env is ignored</span>
  useRestangular<span class="pl-k">:</span> <span class="pl-c1">true</span>/<span class="pl-c1">false</span>, <span class="pl-c">// if true it will create a restangular factory for a module named [module]RestService, e.g.: myModuleRestService. It'll be created if environment settings has a apiUrlBase property.</span>
   envSettingsName<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>envSettings<span class="pl-pds">'</span></span> <span class="pl-c">// contains the name of the global environment settings, it's used as complement to envJsPath.</span>
});</pre>
                </div>
            </li>
            <li>
                <p><strong>loadModules(urlOrModules, options)</strong>
                </p>

                <ul>
                    <li>this function loads all modules returned by the response of the called url. It's recomended if your app has modules that are dynamicaly loaded. The fist param can be a list of modules.</li>
                    <li>options:</li>
                    <li>ignoredModules: list of modules to ignore</li>
                    <li>appJsPath: path to app.js module</li>
                    <li>onloadmodule: event dispatch when module is loaded</li>
                    <li>onfinish: event dispatch when all modules are loaded</li>
                </ul>

                <div class="highlight highlight-javascript"><pre>jd.<span class="pl-c1">factory</span>.<span class="pl-c1">loadModules</span>(<span class="pl-s"><span class="pl-pds">'</span>myModules.json<span class="pl-pds">'</span></span>, {
  ignoredModules<span class="pl-k">:</span> [<span class="pl-s"><span class="pl-pds">'</span>common<span class="pl-pds">'</span></span>],
  appJsPath<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/{module}/app.js<span class="pl-pds">'</span></span>,
  <span class="pl-en">onloadmodule</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">module</span>, <span class="pl-smi">moduleEnvSettings</span>) {
     <span class="pl-c">// event called when it finishes loading each module</span>
  },
  <span class="pl-en">onfinish</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">modules</span>) {
     <span class="pl-c">// event called when it finishes loading all modules</span>
  }
});

Or

jd.<span class="pl-c1">factory</span>.<span class="pl-c1">loadModules</span>([<span class="pl-s"><span class="pl-pds">'</span>myModule1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>myModule1<span class="pl-pds">'</span></span>], {
  appJsPath<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>app/{module}/app.js<span class="pl-pds">'</span></span>,
  <span class="pl-en">onloadmodule</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">module</span>, <span class="pl-smi">moduleEnvSettings</span>) {
     <span class="pl-c">// event called when it finishes loading each module</span>
  },
  <span class="pl-en">onfinish</span><span class="pl-k">:</span> <span class="pl-k">function</span> (<span class="pl-smi">modules</span>) {
     <span class="pl-c">// event called when it finishes loading all modules</span>
  }
});

<span class="pl-c">// myModules.json:</span>
[<span class="pl-s"><span class="pl-pds">'</span>common<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>security<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>billing<span class="pl-pds">'</span></span>]</pre>
                </div>

                <ul>
                    <li>recommended using newModule in your app.js</li>
                </ul>
            </li>
            <li>
                <p><strong>getFileVersion(file)</strong>
                </p>

                <ul>
                    <li>this function translates the original file to the deployed file, using version.json mapping.</li>
                </ul>
            </li>
        </ol>
    </div>
</div>
<!-- /.container-fluid -->